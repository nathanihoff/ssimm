---
output:
  bookdown::pdf_document2:
    toc: no
    number_sections: no
    pandoc_args: !expr rmdfiltr::add_wordcount_filter(rmdfiltr::add_citeproc_filter(args = NULL))
    latex_engine: xelatex
    keep_tex: yes
    #template: svm-latex-ms.tex
# output: 
#   pdf_document:
#     citation_package: natbib
#     keep_tex: true
#     fig_caption: true
#     latex_engine: pdflatex
#     template: svm-latex-ms.tex
header-includes:
  # - \usepackage{setspace}\doublespace
  # - \usepackage{endnotes}
  #- \let\footnote=\endnote
  #- \usepackage{endfloat}
  - \usepackage{fancyhdr}
  - \pagestyle{fancy}
  - \setlength{\headheight}{13.6pt}
  - \rhead{\textit{Hoffmann and Velasco}}
editor_options: 
  chunk_output_type: console
  
citeproc: no
fontfamily: mathpazo
fontsize: 11pt
geometry: margin=1in
indent: yes
link-citations: yes
linkcolor: blue
bibliography: zotero.bib  
csl: apa.csl


title: "Making Migration Sexy: How State and National Policies Influence Migration of Same-Sex Couples"
date: "`r format(Sys.time(), '%B %e, %Y')`"
# author:
# - name: Nathan I. Hoffmann
#   affiliation: Department of Sociology, University of California, Los Angeles
# - name: Kristopher Velasco
#   affiliation: Department of Sociology, University of Texas at Austin
 
author:
- Nathan I. Hoffmann, Department of Sociology, University of California, Los Angeles
- Kristopher Velasco, Department of Sociology, University of Texas at Austin

abstract: "As same-sex couples gain greater social acceptance and new rights, their numbers in the United States are rapidly increasing. Yet few researchers have studied immigrants in same-sex couples on a large scale. Using the American Community Survey from 2008 to 2019, this study compares immigrants in same-sex couples to corresponding different-sex couples in order to characterize and assess the scale of “sexual migration” to the U.S. Moreover, we evaluate how the policy environment regarding same-sex couples shapes migratory patterns. We find that, compared to different-sex immigrant couples, immigrants in same-sex couples come from richer, more democratic countries that are less represented in immigrant networks. Fixed effects models show that as origin countries become more LGBT-friendly, we see more LGB immigrants from those countries in the U.S. On the individual level, immigrants in same-sex couples are more likely to live in progressive U.S. states, an effect that increases in strength as migrants come from for more LGBT-friendly countries of origin. Our findings put into question dominant models of migration that emphasize economic and network effects, suggesting the importance of considering sexuality as well as political and lifestyle motivations more broadly."  
  
keywords: "immigration, same-sex couples, LGBTQ policy, sexuality"   

thanks: "The authors contributed equally to this project."
---

<!-- Turn off hyphenation -->
<!-- \usepackage[none]{hyphenat} -->


```{r setup, include=F}
knitr::opts_chunk$set(echo = F, warning = F, message = F, cache = T, results = 'asis',
                      cache.lazy = F)

library(MASS)
library(janitor)
library(priceR)
library(kableExtra)
library(huxtable)
library(jtools)
library(sjstats)
library(imputeTS)
library(mvtnorm)
library(ordinal)
library(lme4)
library(countrycode)
library(knitr)
library(RColorBrewer)
library(haven)
library(cowplot)
library(srvyr)
library(lmtest)
library(sandwich)
library(here)
library(plm)
library(stargazer)
library(tidyverse)

# knitr::opts_chunk$set(error=TRUE) 

options("yaml.eval.expr" = TRUE)

# theme_set(theme_cowplot(font_family = 'Palatino') + 
theme_set(theme_classic(base_family = 'Palatino') + 
            theme(legend.title=element_blank(), 
                  panel.grid.major.y = element_line('grey80'),
                  legend.background = element_rect(fill = "transparent")))
ggplot <- function(...) ggplot2::ggplot(...) + scale_color_brewer(palette="Dark2") + 
  scale_fill_brewer(palette="Dark2")

options(scipen=1, digits=2)
knit_hooks$set(inline = function(x) {
  prettyNum(x, big.mark=",")
})
knitr::opts_chunk$set(error=TRUE) 


```

```{r load, include = F}

acs_wide <- read.csv(here('data', 'acs_wide.csv'))
acs_couple_policy <- readRDS(here('data', 'acs_couple_policy.rds'))
acs_prop_yrimmig_policy <- read.csv(here('data', 'acs_prop_yrimmig_policy.csv'))
acs_dyad_policy <- read.csv(here('data', 'acs_dyad_policy.csv'))

# acs_oneimm <- read.csv(here('data', 'acs_oneimm.csv'))
# acs_coupled_imms <- read.csv(here('data', 'acs_coupled_imms.csv'))
# acs_prop_yrimmig <- read.csv(here('data', 'acs_prop_yrimmig.csv'))
# acs_dyad <- read.csv(here('data', 'acs_dyad.csv'))


acs_wide_survey <- acs_wide %>% as_survey_design(ids = cluster, weights = hhwt)
acs_ind_survey <- acs_couple_policy %>% as_survey_design(ids = cluster, weights = perwt)


# Smaller dataset for initial ordered logit analyses
set.seed(1859)
acs_couple_policy_small <- bind_rows(
  filter(acs_couple_policy, same_sex == T),
  sample_n(filter(acs_couple_policy, same_sex == F), 1e5)
)


```

```{r intro}
total_df <- acs_wide_survey %>%
  mutate(same_sex = ifelse(same_sex == T, 'Same-Sex', 'Different-Sex')) %>%
  group_by(year, imm_couple, same_sex) %>%
  summarize(n = survey_total(vartype = "ci")) 

same_2013 <- total_df %>%
  filter(year == 2013, same_sex == 'Same-Sex') %>%
  pull(n) %>% 
  sum()

same_2019 <- total_df %>%
  filter(year == 2019, same_sex == 'Same-Sex') %>%
  pull(n) %>% 
  sum()

dif_2013 <- total_df %>%
  filter(year == 2013, same_sex == 'Different-Sex') %>%
  pull(n) %>% 
  sum()

dif_2019 <- total_df %>%
  filter(year == 2019, same_sex == 'Different-Sex') %>%
  pull(n) %>% 
  sum()
```


# Introduction
In 2013, the U.S. Supreme Court made a landmark decision overturning the Defense of Marriage Act. This decision reverberated across society. One important outcome was making immigration by same-sex couples more accessible. While numbers of different-sex couples including immigrants increased by `r round((dif_2019/dif_2013 - 1)*100)` percent from 2013 to 2019 (from `r round(dif_2013 / 1e6,1)` million to `r round(dif_2019 / 1e6,1)` million), those of immigrant same-sex couples grew from `r round(same_2013 /1e3, 1)` thousand to `r round(same_2019 /1e3, 1)` thousand in the same period, an increase of `r round((same_2019/same_2013 - 1)*100)` percent [@ruggles_2021]. Indeed, this time period represents an important moment in which policies governing same-sex couples, both in the U.S. and internationally, are changing rapidly. Although short reports have described the lesbian, gay, and bisexual (LGB) immigrant population [@gates_2013; @goldberg_2021], immigration research has not explicitly analyzed how policy changes are influencing the migration patterns of individuals in same-sex couples into and across the U.S. This is partly due to the fact that conventional migration research focuses on largely economic, cost-benefit analyses and has only recently begun to factor in the role of social policies [@fitzgerald_2014]. Moreover, while gender has been recently recognized as an integral part of the migration process [@lutz_2010; @hondagneu-sotelo_2012], sexuality has received relatively scant attention. As @carrillo_2018 demonstrates, however, sexuality is a salient factor determining immigration decisions. We show that differences between immigrants in same-sex couples and those in different-sex couples cannot be explained solely using classic theories of migration; consequently, not making sexuality an integral part of the research question limits our understanding of the full immigration process. 

Therefore, in this project, we seek to understand how LGBT policies influence same-sex couples' migration patterns. Specifically, do policies at country-of-origin and of U.S. state of residence influence migration patterns of immigrants in same-sex relationships? We integrate two types of data to help answer this question. First, we rely on American Community Survey (ACS) data for 2008 to 2019 [@ruggles_2021], which allows the identification of same-sex couples, immigrant origin, U.S. state of residence, and potentially confounding individual characteristics. Second, we harness original datasets indexing LGBT policy changes in 193 countries and all U.S. states from 1991 to 2019 [@velasco_2020]. We merge these two primary data sources with country- and state-level control variables from the UN, World Bank, U.S. Government, and other sources.  

Our analytic strategy proceeds in four parts. First, we descriptively try to understand who these same-sex couples are. This first step is important seeing as that little is known about this growing population. Simultaneously, we contrast immigrants in same- and different-sex couples, assessing how classic migration variables such as wage differentials, individual income, and co-national networks compare between these groups. Second, we focus on country-of-origin effects, modeling the proportion of a given immigrant group constituted by same-sex couples and how this proportion changes over time in response to the LGBT policy context of the country of origin. Third, in order to assess state effects, we model how the same-sex couple proportion of an immigrant group in a given state changes in response to the changing state LGBT policy context. Lastly, we shift our attention to the individual, assessing how being an immigrant in a same-sex couple, net of other individual factors usually considered in migration analyses, bears upon choice of LGBT policy context within a state. We also consider how this relationship is moderated by LGBT policy context in the country of origin. Finally, given known reporting issues of same-sex couples within the ACS [@gates_2013; @goodnature_2021], we perform a series of sensitivity analyses to probe the robustness of our key insights.

Our research demonstrates that origin country policies matter for levels of immigrants in same-sex couples, but perhaps not in the way scholars would expect. Countries-of-origin with more LGBT-friendly policies send higher proportions of immigrants in same-sex couples. This implies that these policies may enable LGBT individuals looking to migrate, whereas oppressive policies may hinder such ambitions. Second, we find little role of U.S. state policy at the aggregate level of proportion immigrants in same-sex couples. But at the individual level, we find the expected trend: immigrants in same-sex couples are more likely to live in LGBT-friendly states. This effect is moderated by country-of-origin context, however; immigrants in same-sex couples from countries with LGBT-friendly policies are more likely to live in LGBT-friendly states. We find the opposite trend for immigrants in different-sex couples. The findings from this project, robust across several dimensions, highlight how the interaction between sexuality and political context shape migration decisions, underscoring the importance of considering political and "lifestyle" variables in the migration process [@benson_2012; @fitzgerald_2014].


# Background: Changing Policy Landscape for Same-Sex Immigrant Couples

The U.S. has undergone significant shifts in the policies governing LGBT populations at both state and federal levels. Since 2003, the U.S. Supreme Court ruled sodomy laws and the Defense of Marriage Act unconstitutional, legalized same-sex marriages, and curtailed employment discrimination. In response, however, a number of U.S. states implemented new policies hindering LGBT communities on top of existing discriminatory policies like state constitutional bans on marriage equality [@kazyak_2018]. This creates a varied landscape in which state lines significantly demarcate the types of rights and legal environments LGBT people experience. Now, a burgeoning area of scholarship exists to understand the causes of these transformations [@lax_2009; @soule_2004] and, even more recently, their distinct consequences on the lives and well-being of LGBT people [@boertien_2019; @carpenter_2020; @kail_2015; @levy_2017].  

Though this changing policy landscape effects LGBT populations of all types, particular sub-groups within this broad umbrella are likely to be differentially impacted. Same-sex immigrant couples represent a key group especially vulnerable to recent changes. This is because prior to being able to experience recognized rights like marriage or non-discrimination protections, same-sex immigrant couples must first be able to enter into the U.S. Historically, federal U.S. law hindered same-sex immigrant couples’ ability to enter the country due to the government’s lack of recognition of their relationship [@humanrightswatch_2006]. One of the few mechanisms by which queer migrants could enter into the U.S., then, was through asylum claims -- an invasive process in which migrants needed to “prove” their sexual desires and persecution [@humanrightswatch_2006]. These broad legal exclusions often carry over to academic scholarship as well. Analyses of domestic LGBT communities assume citizenship and migration research presents migrants as heterosexual [@luibheid_2008]. The academic literature that does acknowledge the realities of queer migrants is largely centered on the asylum claims and offers a qualitative insight into how queer migrants navigate this process [@vogler_2019]. As such, however, there is presently a shallow understanding of the factors broadly influencing the migratory patterns of same-sex immigrant couples beyond this pathway and how these patterns align or diverge from their well-studied heterosexual counterparts.

```{r total-pop, fig.cap = 'Estimated totals of different- and same-sex couples containing one or two immigrants, 2008-2019, with 95% confidence intervals. Vertical line placed at the year 2013, when DOMA was overturned.'}

total_df %>%
  mutate(`Total population (thousands)` = n/1000,
         n_low = n_low/1000, n_upp = n_upp/1000,
         Year = year) %>%
  ggplot(aes(x = Year, y = `Total population (thousands)`, 
             color = imm_couple)) +
  geom_line() +
  geom_ribbon(aes(ymin = n_low, ymax = n_upp, fill = imm_couple, col = NULL), alpha = .2) +
  geom_vline(xintercept = 2013, linetype = 'dashed') +
  facet_wrap(~same_sex, scales = "free") +
  xlim(2007, 2019) +
  theme(legend.justification=c(1,0),
        legend.position=c(.15,.35))

```

The federal environment governing immigration significantly changed after 2013. The U.S. Supreme Court opinion ruling the Defense of Marriage Act (DOMA) unconstitutional opened the door for more same-sex immigrant couples to enter the U.S. under the same process long-governing different-sex couples. Indeed, as Figure \ref{fig:total-pop} highlights, the number of same-sex immigrant couples in the U.S. grew significantly following this ruling -- especially when compared to different-sex couples. In 2013, there were `r round(same_2013 /1e3, 1)` thousand. By 2019, this grew to `r round(same_2019 /1e3, 1)` thousand. Aside from allowing gay and lesbian families to remain unified, this national opening created an important moment for the scholarly community as well. Now, more careful investigation into the factors both pushing and pulling same-sex immigrant couples into the U.S. can be conducted beyond idiosyncratic asylum claims. The present research fits squarely within this critical research gap.


# Understanding Influences on Migration Patterns
## Conventional Explanations
Our analysis compares conventional explanations for migration to political ones related to LGBT policy. These conventional explanations are frequently combined in a "gravity model," which Anderson [-@anderson_2011, p. 134] describes in general terms: "A mass of goods or labor or other factors of production supplied at origin $i$, $Y_i$, is attracted to a mass of demand for goods or labor at destination $j$, $E_j$, but the potential flow is reduced by the distance between them, $d_{ij}$." This model continues to be widely applied to predict large-scale migration [@karemera_2000; @beine_2016; @poot_2016].  

Neoclassical economic theories motivate the traditional variables to include. Such theories posit that promise of material gain is a frequent motivation to migrate [@hatton_2005a; @todaro_1980]; at the micro level, individuals who stand to gain greater returns to their education are more likely to migrate. At the macro level, these theories predict that migrants will follow wage and unemployment differentials across countries. Hence gravity models usually include difference in per capita GDP between sending and receiving countries. To account for migration costs, gravity models adjust for distance: immigrants are more likely to migrate between proximate countries, especially those that share a border.  

Although the traditional gravity model focuses only on distance and economic "mass," in recent years it has been refined with the incorporation of sociological theories of migration [@massey_1999], including political, cultural, and network variables [@karemera_2000; @fitzgerald_2014; @mayda_2010]. Scholars have shown that shared language, colonial history, and democracy matter in the sending country, and immigrant rights matter in the receiving country. Recent models also highlight the importance of measures of immigrant networks, such as co-national immigrant stock [@beine_2016; @poot_2016]. Though the incorporation of sociological theories into migration studies is a welcomed development, as mentioned, previous scholarship has not explicitly applied these analyses and insights into the migration of same-sex couples. Consequently, we do not know if these same patterns hold. But rather than offering a direct comparison into how these previous models apply to same-sex couples, we seek to intervene within migration scholarship by explicitly considering how sexuality, and the governence of it, additionally influence migration processes.

<!-- structural explanations point to how the disruption of local economies by global forces spurs out-migration [@piore_1979; @wallerstein_1979]. Network theory explains for why migration streams often continue to flow in full force even after wage differentials decrease [@massey_1987], while work on the "migration industry" shows how brokers, recruiters, smugglers, and other "entrepreneurs" initiate and maintain migrant flows [@hernandez-leon_2013]. However, there is little reason to believe that the economic, structural, network, and institutional forces that shape migration of heterosexual immigrants differ from those that affect LGB immigrants. These theories fall short of explaining the rapid rise of immigrants in same-sex couples in the U.S.  -->

<!-- The problem lies in two conspicuous absences in mainstream migration theory. The first is the lack of a large role for the state. Outside of violent contexts triggering refugee flows [@fitzgerald_2018], scholars of migration rarely focus on the political factors that both constrain and enable migration in sending and receiving countries. In recent years, some research has emerged that does consider political variables explicitly. For example, on the receiving country side, @fitzgerald_2014 show that safeguards for immigrant rights are important predictors of immigration, even in models that control for the usual economic, distance, and network variables in a "gravity model." Other scholars have looked at sending-country policies relevant to emigration, such as dual citizenship laws [@leblang_2017] and autocratic restraints on exit [@miller_2018]. State policy relevant to particular subgroups or not obviously related to migration, however, has received little study.   -->

<!-- Second, the dominant migration literature rarely considers how identity might shape migration desires. Recent research in "lifestyle migration" [@benson_2012] begins to probe the non-economic hopes and aspirations that might encourage settling in a new country. And although gender is slowly being recognized as an integral consideration in studies of migration [@lutz_2010; @hondagneu-sotelo_2012], sexuality has received comparably little attention. Moving beyond the dominant migration theories synthesized by Massey et al. [-@massey_1999], this paper sheds light on how the intersection of state policy and sexuality shapes migration decisions.  -->

<!-- As immigrants in same-sex couples become more prevalent in the U.S., new theory is needed to explain -->

<!-- @garip_2012 argues that migration theories arise within historical contexts to explain the most prevalent type of migration at the time. -->

<!-- Micro- and macroeconomic theories underscore that promise of material gain is a frequent motivation to migrate [@hatton_2005a]. Yet migration decisions rarely occur at the individual level; proponents of the so-called New Economics of Labor Migration (NELM) argue that the migration decision is a family affair devised to mitigate risk and diversify income streams [@stark_1985]. Another influential explanation for why migration streams often continue to flow in full force even after wage differentials decrease lies in network theory; migrants share information and resources to lower the cost of migration and settling in the destination country [@massey_1987]. World Systems Theory    -->

<!-- These three theories have proven hugely influential in migration studies.  -->

## Our Intervention
Though migration scholarship typically emphasizes economic considerations as institutionalized in the gravity model, we argue that it is also imperative to take sexuality, and the state’s role in governing sexuality, into account for understanding migratory patterns [@carrillo_2018; @cantu_2009]. One reason why this area of research has yet to be fully considered, in addition to previous restrictions outlined, is because the literature largely assumes immigrants are heterosexual or simply neglects to consider them as fully constitutive, diverse sexual beings [@canaday_2009; @epstein_2014; @gonzalez-lopez_2005].  

Consequently, analyses into how sexuality motivates migratory decisions or how migration reimagines sexual behaviors and understandings are limited [@carrillo_2018]. Even more limited are explicit analyses into how policies such as same-sex marriage, hate crime protections, sodomy, and the like, further influence migration patterns. The nascent scholarship concerning queer migrants that does exist, though, suggests that policy environments are a central concern when making these decisions [@cantu_2009; @luibheid_2005]. For example, @nakamura_2017 interview same-sex couples who fled to Cananda due to the U.S.' lack of policies recognizing and affirming their relationships. Therefore, below, we theorize why LGBT policies at country-of-origin and residing U.S. state influence the push and pull of same-sex couples within the U.S.  

Laws governing LGBT communities have significantly transformed. These changes are part of a broader global trend in which LGBT rights are increasingly incorporated within existing human rights frameworks -- pressuring countries to respond in turn [@velasco_2018]. These new dynamics have spurred research into understanding the causes of policy reforms and why countries have taken such varied approaches to enacting reform -- both in expanding rights but also further restricting them [@ayoub_2016]. Only recently are scholars starting to understand the direct consequences of these changes on the lives of LGBT people [@boertien_2019; @carpenter_2020; @kail_2015]. Though this emerging scholarship within the U.S. context focuses largely on health and well-being, particularly concerning marriage laws, there are several reasons why these new realities are likely to also influence migration outcomes.

Sexuality has long factored into migratory decisions. However, as the global awareness of LGBT rights expands, sexuality is increasingly a salient and important factor when deciding to leave one’s home country [@mole_2018a; @murray_2016]. Part of this is due to international organizations’ construction of sexuality as a legitimate basis for leaving. For example, in 2008, the United Nations High Commissioner for Refugees issued a new guidance note for why and how countries should consider sexual orientation and gender identity when granting asylum claims. The note states:  

>“[I]ndividuals experience serious human rights abuses and other forms of persecution due to their actual or perceived sexual orientation and/or gender identity. While persecution of Lesbian, Gay, Bisexual, Transgender and Intersex (hereafter “LGBTI”) individuals and those perceived to be LGBTI is not a new phenomenon, there is greater awareness in many countries of asylum that people fleeing persecution for reasons of their sexual orientation and/or gender identity can qualify as refugees [...].”

The note continues to guide various authorities to consider discriminatory domestic policies when evaluating asylum claims as such policies “can create or contribute to an oppressive atmosphere of intolerance and generate a threat of prosecution,” [@unhcr_2008, p. 8]. International organizations like the European Union and various countries have since followed [@giametta_2020].  

As globalization of LGBT rights increases, so too does the transnational flow of information, cultural content, and overall visibility [@ayoub_2016; @ayoub_2017]. For example, access to gay characters in film and gay content on the Internet contributed toward Iranian refugees to seek sexual freedom and affirming political environments in the West [@karimi_2020]. Altogether, these developments in the global environment helped to shift sexuality, which has always been in the background of migratory decisions, to the foreground.  

Despite this growing awareness of LGBT rights, countries vary greatly in their policy environments [@velasco_2020]. We theorize that country-of-origin policies shape migration into the U.S. by same-sex couples in two broad ways. First, as mentioned, migrants may seek to escape repressive contexts. As Adur [-@adur_2018, p. 321] states, “sexuality also shapes migration as LGBTI immigrants relocate in pursuit of spaces that they *imagine* will be safer and more liberal” (emphasis theirs). Although the U.S. is certainly less progressive and inviting compared to many other Western states, high-profile developments such as marriage equality can contribute to an imagined openness. To date, queer migration research largely studies same-sex couples seeking to leave repressive conditions. Part of this is because of the U.S. policy environment which, for so long, did not define same-sex couples as “family” and left asylum as one of the few viable mechanisms for entry [@luibheid_2008; @vogler_2016]. Similarly, another strand of research documents people in more oppressive contexts seeking out partners in more equitable locations who can then sponsor them through the immigration process [@carrillo_2018; @corey-boulet_2019]. These qualitative studies would suggest that immigrant same-sex couples are largely fleeing repressive contexts, but does this pattern hold more broadly?   

Alternatively, same-sex couples from countries with greater recognition and access to sexuality-related rights and services may be in better positions to make such an important, and expensive, move. Long-standing research on immigrant selection demonstrates that migrants are typically from stronger social positions -- more formal education, higher incomes, and more prestigious occupations [@feliciano_2020]. Given the high barriers to migrating, it is possible that same-sex couples are more likely to come from countries that have affirming and supportive policies in place, such as protections against employment discrimination or the legal and material benefits of marriage. Such policies enable and facilitate the employment security and the social and human capital necessary to navigate the immigration process. Additionally, being from a country where the state recognizes and validates one’s sexuality and relationships may make such commitments more likely or may make survey respondents, once in the U.S., more comfortable disclosing such relationships.  

While these country-of-origin policies may influence the “push” of same-sex couples out of their home country, the varied policy environments across U.S. states are likely to differentially “pull” these couples. Typically, a strong predictor of where migrants locate within the U.S. are network effects -- they locate where the people they know are located [@massey_1987; @portes_1998; @palloni_2001]. Existing research does highlight, though, that gay and lesbian couples within the U.S. were likely to leave states without marriage equality prior to national recognition [@beaudin_2017]. If this results in a greater concentration of same-esx couples in states with marriage equality and other protective policies, it increases the chances that same-sex immigrant couples know someone in those states as well -- seeing as queer migrants often have strong cross-national networks that relay such information [@stella_2020]. Additionally, if migrants are coming from a country with greater legal protections, they are unlikely to want to relocate to a state where such rights are no longer recognized -- making the political environment acutely important. Of course, this is predicated on the assumption migrants take into account these sub-national variations -- which they very well may not do. Consequently, the "pull" to particular states may operate independently from specific state laws affirming LGB people and their relationships.  

In sum, it is evident that sexuality, and the policies governing it, are extremely salient factors driving migratory decisions. Aside from qualitative examinations into queer migrants, especially asylum seekers, there is no large-$N$ investigation into how the significant transformation of LGBT policies -- both globally and across U.S. states -- influence migration patterns in the U.S. Therefore, this research seeks to correct this gap within the literature by providing such an analysis and to further understand how the changing policy landscapes are differentially influencing the lives of queer people depending on their social positions.


## Contrasting the Demography of Same-Sex and Different-Sex Couples
Prior to getting to the data and results of this analysis, it is first important to contextualize the present article within existing demographic scholarship. Previous demographic research suggests how characteristics salient to the migration process may differ between same- and different-sex couples. Cohabiting same-sex couples are more likely to reside in states in the Northeast and West, such as Vermont, Massachusetts, California, and Oregon [@gates_2013a], that have often been at the forefront in safeguarding LGBT rights. The same-sex population is growing most rapidly, however, in the Midwest and South (*ibid.*). Regardless of state, same-sex couples are more concentrated in urban areas, although this is more true for men than women [@baumle_2009]. This evidence suggests that immigrants in same-sex couples are also likely to choose progressive states and cities as their place of residence.  

In the labor market, men in same-sex couples tend to earn less than their heterosexual counterparts, but women tend to earn more [@klawitter_2015]. On average, married same-sex couples are older and have higher earnings than their different-sex counterparts [@fisher_2018], while results for unmarried couples are mixed [@baumle_2009]. If immigrants in same-sex couples have higher earnings than heterosexual immigrants, then the typical push and pull factors of immigration may affect them differently. Same-sex couples also tend to be less homogamous in age, education, and race/ethnicity than their different-sex counterparts [@schwartz_2009]. Finally, although male same-sex romantic relationships generally have higher levels of instability than female or different-sex relationships [@joyner_2017], the dissolution rates for cohabiting same- and different-sex couples are similar [@manning_2016]. If LGB immigrants experience higher rates of union dissolution, then our estimates of the proportion of immigrants who are in same-sex couples represents a lower bound.

Note from Kris: I'm wondering if we should actually incorporate the "labor market" paragraph into the "Conventional Explanations" section? Put in there why we think conventional explanations apply/differ to same-sex couples? And then,the first paragraph could kinda go into theorizing why state policies may matter for same-sex couples but not different sex?

# Data
## Identifying Same-Sex Couples in the ACS
We merge individual-level data on immigrants in the U.S. with state- and country-level variables from a variety of datasets. The individual data come from the 2008 to 2019 ACS [@ruggles_2021]. Each year, the ACS surveys a 1% sample of the U.S. population about their education, occupation, income, family structure, immigration status, country of origin, location, and a variety of other individual and household attributes. We define a same-sex couple as two individuals of the same sex in the same household who report their relationship as "spouse" or "unmarried partner." We limit the sample to individuals who immigrated at the age of 18 or older. The 11 years of survey data contain `r nrow(filter (acs_wide, same_sex == T))` same-sex couples that include at least one immigrant, for a total of `r nrow(filter(acs_couple_policy, same_sex == T))` immigrants in same-sex couples with complete data. These immigrants are compared to `r nrow(filter (acs_wide, same_sex == F))` corresponding different-sex couples (containing `r nrow(filter(acs_couple_policy, same_sex == F))` individual immigrants). Using these data, we construct different dependent variables, corresponding to the analysis of interest. Below, we outline how we utilize these data to construct dependent variables based on each analysis.

Measuring the prevalence of same-sex couples in the U.S. is difficult [@michaels_2013]. For one, identification of LGB individuals in data sources such as the ACS is only possible for those who self-identity as living with a same-sex spouse or unmarried partner [@baumle_2009, p. 6]. Since the surveys lack questions about sexual orientation, LGB individuals who do not live with a same-sex romantic partner or who do not feel comfortable with the partner labels of the ACS are not part of the analysis. In addition, some measurement error may result when different-sex couples accidentally misspecify the gender of one of the partners [@gates_2009a]; beginning in 2008 the Census Bureau made changes to ACS gender and partnership questions in order to prevent such errors [@u.s.censusbureau_2013], so we rely on data only from 2008 onward, but pitfalls remain.  

In a Census Bureau working paper, @kreider_2015 use personal information such as names and addresses match same-sex couples from the 2010 ACS to Social Security administrative data. They find that 58 percent of married couples coded as same-sex in the ACS are coded as different-sex in the administrative data. The corresponding sex mismatch rate for unmarried same-sex couples is 7 percent. (Our data include `r sum(acs_wide$related_partner == 'Spouse' & acs_wide$same_sex == T)` married and `r sum(acs_wide$related_partner == 'Unmarried Partner' & acs_wide$same_sex == T)` unmarried same-sex immigrant couples.) A follow-up study [@kreider_2017] shows that these mismatch rates appear to have fallen: In a 2016 ACS test module that included explicit categories for different- and same-sex spouses and partners, 31 percent of married and 3 percent of unmarried same-sex couples had inconsistent sex responses. This decreasing mismatch rate may be due to the greater numbers of same-sex couples openly identifying themselves as well as the growing popularity of responding to the ACS via Internet (see Supplementary Material), a response mode introduced in 2013 which is now the default [@u.s.censusbureau_2017]. In the 2016 test of the ACS, the mismatch rate for mail-in responses was 47 and 6 percent for married and unmarried same-sex couples, respectively, whereas for Internet responses they were only 22 and 2.4 percent [@kreider_2017].^[An interview-based CATI/CAPI response mode is sometimes administered as well (to `r with(filter(acs_couple_policy, same_sex == T), round(sum(respmode == 'CATI/CAPI')/nrow(filter(acs_couple_policy, same_sex == T)),2)*100)` percent of our sample of immigrants in same-sex couples), but the 2016 study did not assess its error rate. In the 2010 ACS, Kreider and Lofquist (2015) find CATI/CAPI sex reporting mismatch for 46 and 13 percent for married and unmarried same-sex couples, respectively.] In our sample of immigrants in same-sex couples, `r sum(acs_couple_policy$respmode == 'Mail' & acs_couple_policy$same_sex == T)` responded by mail and `r sum(acs_couple_policy$respmode == 'Internet' & acs_couple_policy$same_sex == T)` responded by Internet survey.  

Despite these difficulties, many researchers have relied on ACS data to draw demographic conclusions about same-sex couples in the U.S., usually without making accommodations for measurement error [e.g. @poston_2017; @boertien_2019; @giddings_2014; @gates_2013; @goldberg_2021]. In several ways, we test the sensitivity of our results, especially to the possibility that a large proportion of apparently same-sex couples misreported a partner's sex. However, such adjustments assume that sex response error occurs randomly throughout the immigrant population. Beginning in 2019, the ACS added explicit "opposite-sex" and "same-sex" categories to the relationship questions, so future work on same-sex couples in the ACS will be more reliable [@goodnature_2021].


## Explanatory Variables
Our explanatory variables of interest are the LGBT policy contexts in country-of-origin and U.S. state of residence. To create the U.S. state policy index, we compile data from the Movement Advancement Project, a leading LGBT organization in the U.S. that collects data on a number of relevant policies. Our state index encompasses both progressive policies (full marriage equality, state recognition of civil unions and domestic partnerships, ban on all employment and housing discrimination based on sexual orientation, hate crime protections based on sexual orientation, legal joint adoption by same-sex couples, and a ban on conversation therapy for minors) and regressive policies (criminalization of sodomy, state constitutional bans of marriage equality, religious freedom exemptions to discriminate against same-sex couples in adoption, and state-level bans on local non-discrimination ordinances encompassing sexual orientation). The state index ranges from `r min(acs_couple_policy$state_policy, na.rm = T)` to `r max(acs_couple_policy$state_policy, na.rm = T)`, and the mean score of country of origin for immigrants in our sample is `r mean(acs_couple_policy$state_policy, na.rm = T)`.

We measure the origin country policy environment using the LGBT Policy Index [@velasco_2018]. This index comprises 14 policies, many similar to those above, but including additional policies like the death penalty for homosexual acts, propaganda laws limiting free speech for LGBT communities, and equal age of consent between same-sex and opposite-sex couples. Both indices are created by summing the net total of progressive policies (scored $+1$) over regressive policies (scored $-1$). The state index ranges from `r min(acs_couple_policy$origin_score, na.rm = T)` to `r max(acs_couple_policy$origin_score, na.rm = T)`, and the mean score of country of origin for immigrants in our sample is `r mean(acs_couple_policy$origin_score, na.rm = T)`.  

Immigrants are assigned U.S. state index scores based on their state of residence as reported in the ACS. They are assigned country-of-origin index scores based on their year of immigration. Since the country policy index begins at 1991, we anyone who immigrated before 1991 gets assigned the 1991 value ^[In additional models, not shown, we limit the sample only to those who immigrated in 1991 or after tather than assigning those who immigrated prior to 1991 their country value at 1991. Results are substantively similar and available upon request].  

Aside from the country and state indices, we also include a binary variable to indicate the change in national policy environment within the U.S. following the overturning of DOMA. This represents an important shift opening up traditional pathways of immigration to same-sex couples. We also include an interaction term between this post-DOMA indicator and country-of-origin index because we theorize that the effects will be more pronounced following this period.

## Control Variables
Our country- and state-level controls come from a variety of sources. Country-of-origin controls for bilateral distance, contiguous border, common official language, common ethnic language, and whether the country was a former colony of the U.S. come from CEPII's GeoDist dataset [@mayer_2011]. Difference in wages, calculated as difference in per capita GDP at purchasing power parity, come from the Penn World Table [@feenstra_2015], and we rely on World Bank data for differences in unemployment rates [@worldbank_2020]. We use Polity5 measures of democratization of the country of origin [@marshall_2018], with linear interpolation for missing years. We proxy network effects by dividing each country's immigrant stock by the total number of immigrants in the U.S. in a given year, using the World Bank's Global Bilateral Migration Database [@ozden_2011] for 1960, 1970, and 1980 and the UN's Trends in International Migrant Stock report for [@unitednations_2017] for 1990, 1995, 2000, 2005, 2010, 2015, and 2017, linearly interpolating to yield an annual time series from 1960 to 2020. For state controls, we use per capita income by year from the Bureau of Economic Analysis [@bea_2020] and state-level annual unemployment rates from the Bureau of Labor Statistics [@bls_2020]. All monetary variables are adjusted to 1999 U.S. dollars.  

For our individual-level analysis we include individual controls from the ACS for reported sex, age, education (with categories for less than high school, high school, some college, and college), year of immigration, log positive income, and a binary indicator for income reported to be 0 or less. 



# Analytic Strategy
Our first goal is to isolate the effects of country-of-origin LGBT policy on the immigration of immigrants in same-sex couples. The ideal survey would follow potential immigrants over time and have information about sexual orientation, allowing us to estimate how the probability of migrating and choice of U.S. state of residence vary by sexual orientation. This ideal dataset does not exist, but we approximate it at the macro level. We take the number of immigrants in same-sex couples from a given country and a given year of immigration and divide by the total number of immigrants from that country-year. We then multiply by 100 to yield a percentage. In effect this controls for aspects of the migration process common to all immigrants from a given country; if sending-country LGBT policy has no effect on migration rates of LGB immigrants, then we would expect these proportions to be similar across countries. However, even if proportions of immigrants in same-sex couples vary between countries, LGBT policy may not be the cause; perhaps LGB immigrants respond idiosyncratically to gravity-model variables that may covary with LGBT policy, such as country income, unemployment, democratization, relationship to the U.S., and immigrant networks, so we control for these variables in our preferred model and estimate using ordinary least squares (OLS) regression. Our preferred model also includes country fixed effects to account for unobserved heterogeneity within countries. All of these models use country-clustered standard errors. To assess the influence of the 2013 Supreme Court decision on DOMA, we also add a dichotomous variable for whether the year of immigration was later than 2013.  

Our next set of models focus on U.S. state LGBT policy. We reshape the data so that each observation is the proportion of immigrants in same-sex couples from country $x$ in state $y$ in year $z$, then multiply by 100. As in the previous set of models, this reshaping acts to control for aspects of migrant settlement common to immigrants from the same country. We regress this proportion on state and sending-country policy scores, controlling for the same country-level attributes as in the previous set of models and adding state-level controls for per capita income and unemployment rate. We include state and country-of-origin fixed effects, and we cluster errors at the state level.  

Our final set of models turns toward the individual: conditional on immigrating to the U.S., do immigrant in same-sex couples choose more LGBT-friendly states to reside in? And how does sending-country LGBT context moderate this relationship? This part of the analysis uses ordered logistic regression to predict the policy index of state of residence. Whereas the full U.S. state policy index ranges from `r min(acs_couple_policy$state_policy, na.rm = T)` to `r max(acs_couple_policy$state_policy, na.rm = T)`, we break up the index into three "bins": repressive (0 and less), neutral (1 or 2), and progressive (3 and greater). We regress this ordered categorical outcome on a same-sex indicator and country-of-origin policy score, interacting these variables in our preferred model. The interaction term estimates the possibly moderating effect of origin-country policy context. We also control for individual attributes that could possibly confound our results, interacting these with the same-sex indicator, and we include survey-year fixed effects and country-clustered standard errors.


# Results
## Descriptive statistics
We first estimate total numbers of immigrants in same- and different-sex couples, applying survey weights to obtain population-level estimates from the ACS. Figure \ref{fig:total-pop} shows that whereas numbers of different-sex immigrant couples have steadily increased over the period of study, numbers of same-sex immigrant couples have increased much more rapidly, especially since the the 2013 Supreme Court decision overturning DOMA.  

```{r desc, fig.cap = 'Descriptive statistics for immigrants in couples 2008-2019, with survey weights and 95% confidence intervals. All currency in 1000s of 1999 dollars.'}
income <- acs_ind_survey %>%
  mutate(same_sex = ifelse(same_sex == T, 'Same-Sex', 'Different-Sex')) %>%
  group_by(year, same_sex) %>%
  summarize(var = survey_mean(inctot, vartype = "ci", na.rm = T)) %>%
  mutate(var_name = 'Individual Income')

# hwsei <- acs_ind_survey %>%
#   mutate(same_sex = ifelse(same_sex == T, 'Same-Sex', 'Different-Sex')) %>%
#   group_by(year, same_sex) %>%
#   summarize(var = survey_mean(hwsei, vartype = "ci", na.rm = T)) %>%
#   mutate(var_name = 'Hauser and Warren Socioeconomic Index')
# 
# nchild <- acs_ind_survey %>%
#   mutate(same_sex = ifelse(same_sex == T, 'Same-Sex', 'Different-Sex')) %>%
#   group_by(year, same_sex) %>%
#   summarize(var = survey_mean(nchild, vartype = "ci", na.rm = T)) %>%
#   mutate(var_name = 'Number of Children')
# 
# years <- acs_ind_survey %>%
#   mutate(same_sex = ifelse(same_sex == T, 'Same-Sex', 'Different-Sex')) %>%
#   group_by(year, same_sex) %>%
#   summarize(var = survey_mean(years_in_us, vartype = "ci", na.rm = T)) %>%
#   mutate(var_name = 'Years in U.S.')

# distance <- acs_ind_survey %>%
#   mutate(same_sex = ifelse(same_sex == T, 'Same-Sex', 'Different-Sex')) %>%
#   group_by(year, same_sex) %>%
#   summarize(var = survey_mean(distw, vartype = "ci", na.rm = T)) %>%
#   mutate(var_name = 'Distance to Country of Origin (KM)')
# 
# unemp <- acs_ind_survey %>%
#   mutate(same_sex = ifelse(same_sex == T, 'Same-Sex', 'Different-Sex')) %>%
#   group_by(year, same_sex) %>%
#   summarize(var = survey_mean(unemp_dif, vartype = "ci", na.rm = T)) %>%
#   mutate(var_name = 'Difference in Unemployment Rates')

prop_stock <- acs_ind_survey %>%
  mutate(same_sex = ifelse(same_sex == T, 'Same-Sex', 'Different-Sex')) %>%
  group_by(year, same_sex) %>%
  summarize(var = survey_mean(stock_prop, vartype = "ci", na.rm = T)) %>%
  mutate(var_name = 'Proportion Immigrant Stock in Year of Migration')

wage_dif <- acs_ind_survey %>%
  mutate(same_sex = ifelse(same_sex == T, 'Same-Sex', 'Different-Sex')) %>%
  group_by(year, same_sex) %>%
  summarize(var = survey_mean(wage_dif, vartype = "ci", na.rm = T)) %>%
  mutate(var_name = 'Bilateral Wage Differential in Year of Migration')

polity5 <- acs_ind_survey %>%
  mutate(same_sex = ifelse(same_sex == T, 'Same-Sex', 'Different-Sex')) %>%
  group_by(year, same_sex) %>%
  summarize(var = survey_mean(polity5, vartype = "ci", na.rm = T)) %>%
  mutate(var_name = 'Polity5 Score in Year of Migration')

# state_income <- acs_ind_survey %>%
#   mutate(same_sex = ifelse(same_sex == T, 'Same-Sex', 'Different-Sex')) %>%
#   group_by(year, same_sex) %>%
#   summarize(var = survey_mean(state_income, vartype = "ci", na.rm = T)) %>%
#   mutate(var_name = 'U.S. State of Residence Per Capita Income')

bind_rows(income, wage_dif, polity5, prop_stock) %>%
  rename(Year = year) %>%
  ggplot(aes(x = Year, y = var, color = same_sex)) +
  geom_line() +
  geom_ribbon(aes(ymin = var_low, ymax = var_upp, fill = same_sex, col = NULL), alpha = .2) +
  facet_wrap(~var_name, scales = "free") +
  ylab('') +
  theme(legend.justification=c(1,0),
      legend.position=c(.22,.83))
 
```

How do same- and different-sex immigrant couples differ in their individual attributes? Do variables typically used in "gravity models" for migration differ between the groups? Figure \ref{fig:desc} compares immigrants in same- and different-sex couples on four variables. First, macroeconomic theory predicts that difference in wages across countries is one of the most important motivations for migration. The first panel in Figure \ref{fig:desc} shows that the wage differential is indeed positive for both groups of immigrants, but it is significantly more positive for immigrants in different-sex couples. Statistics for the unemployment rate differential (not shown) indicate similar trends: LGB immigrants come from countries with lower unemployment rates. These findings indicate that macroeconomic considerations may be less important to the migration of LGB immigrants. The second panel corroborates this finding on the individual level: not only do immigrants in same-sex couples come from countries with higher per capita GDP, but they individually tend to earn more than immigrants in different-sex couples. Additional analyses (not shown) demonstrate that immigrants in same-sex couples also tend to work in professions with higher occupational prestige scores and have somewhat higher education qualifications, indicating that they may come from more privileged social origins than their heterosexual counterparts.  

Panel three of Figure \ref{fig:desc} compares democracy level of country of origin at time of migration for immigrants in our study. We see that levels of democracy tend to be higher for immigrants in same-sex couples, indicating that political context may play a more important or different role in their migration. Finally, the fourth panel of Figure \ref{fig:desc} looks at a measure of network effects: at the time of immigration, what is the proportion of total immigrants in the U.S. from the country of origin of members of our sample? Compared to different-sex couples, immigrants in same-sex couples immigrated from countries that were less represented in the U.S. population at the time of migration. This indicates that the network effects that attract migrants from the same country of origin may be less relevant to LGB immigrants.   

Although we see significant differences between same- and different-sex couples on a number of important migration variables, none shows the sudden jump in recent years reflected in Figure \ref{fig:total-pop}. Turning to LGBT policy may better explain this surge. Figure \ref{fig:policy-desc} charts the average country-of-origin and U.S.-state LGBT policy score for the immigrants in our sample over time, comparing means for immigrants in same- and different-sex couples. The left panel shows that country-of-origin index at time of migration is generally higher for immigrants in same-sex couples, and since 2013 it has rapidly increased. Immigrants in same-sex couples tend to come from more progressive countries, and this trend tracks closely with the overall population of this group. The right panel indicates less of a difference in U.S. state policies, although states where immigrants in same-sex couples live tend to score somewhat higher. 

```{r policy-desc, fig.cap = 'Mean country-of-origin and U.S. state policy index score for immigrants in same- and different-sex couples, 2008-2019, with 95% confidence intervals.'}


origin_df <- acs_ind_survey %>%
  mutate(same_sex = ifelse(same_sex == T, 'Same-Sex', 'Different-Sex')) %>%
  group_by(year, same_sex) %>%
  summarize(`Policy Score` = survey_mean(origin_score, vartype = "ci", na.rm = T)) %>%
  mutate(var = 'Country-of-Origin Index')

state_df <- acs_ind_survey %>%
  mutate(same_sex = ifelse(same_sex == T, 'Same-Sex', 'Different-Sex')) %>%
  group_by(year, same_sex) %>%
  summarize(`Policy Score` = survey_mean(state_policy, vartype = "ci", na.rm = T)) %>%
  mutate(var = 'U.S. State Index')

bind_rows(origin_df, state_df) %>%
  rename(Year = year) %>%
  ggplot(aes(x = Year, y = `Policy Score`, 
             color = same_sex)) +
  geom_line() +
  geom_ribbon(aes(ymin = `Policy Score_low`, ymax = `Policy Score_upp`, 
                  fill = same_sex, col = NULL), alpha = .2) +
  facet_wrap(~var, scales = "free") +
  theme(legend.justification=c(1,0),
        legend.position=c(.25,.65))
```



```{r country-tab}
country_tab <- acs_couple_policy %>%
  group_by(bpld, same_sex) %>%
  count(wt = perwt) %>%
  pivot_wider(names_from = 'same_sex', values_from = 'n') %>%
  mutate(prop_samesex = round(100*`TRUE` / `FALSE`, 2)) %>%
  arrange(desc(prop_samesex)) %>%
  .[1:10,] %>%
  mutate(prop_samesex = paste0(prop_samesex, ' %')) %>%
  rownames_to_column() %>%
  left_join(acs_couple_policy %>%
              group_by(bpld) %>%
              summarize(`Mean policy score` = 
                          weighted.mean(origin_score, na.rm = T, w = perwt))) %>%
  select(Rank = rowname, `Country of origin` = bpld, `Proportion same-sex` = prop_samesex,
         `Mean policy score`)

country_tab %>%
  kable(booktabs = T, 
        linesep = '',
        caption = 'Sending countries ranked by proportion immigrant couples with same-sex partners') %>%
      footnote(general = "American Community Survey 2008-2019. Authors\' calculations.",
           general_title = 'Source:',
           footnote_as_chunk = T) 


country_vec <- country_tab$`Mean policy score`
names(country_vec) <- country_tab$`Country of origin`


# acs_couple_policy %>%
#   filter(year == 2008) %>%
#   group_by(bpld, same_sex) %>%
#   count(wt = perwt) %>%
#   pivot_wider(names_from = 'same_sex', values_from = 'n') %>%
#   arrange(desc(`TRUE`)) %>%
#   .[1:10,] %>%
#   rownames_to_column() %>%
#   left_join(acs_couple_policy %>%
#               filter(year == 2008) %>%
#               group_by(bpld) %>%
#               summarize(origin_score = mean(origin_score)) %>%
#               select(bpld , origin_score))

```

```{r state-tab}
state_tab <- acs_wide %>%
  filter(state != 'District of Columbia') %>%
  group_by(state, same_sex) %>%
  count(wt = hhwt) %>%
  pivot_wider(names_from = 'same_sex', values_from = 'n') %>%
  mutate(prop_samesex = round(100*`TRUE` / `FALSE`, 2)) %>%
  arrange(desc(prop_samesex)) %>%
  .[1:10,] %>%
  mutate(prop_samesex = case_when(
    nchar(prop_samesex) == 4 ~ paste0(prop_samesex, ' %'),
    nchar(prop_samesex) == 3 ~ paste0(prop_samesex, '0 %'),
    nchar(prop_samesex) == 1 ~ paste0(prop_samesex, '.00 %'))) %>%
  left_join(acs_couple_policy %>%
              group_by(state) %>%
              summarize(`Mean policy score` = 
                          weighted.mean(state_policy, na.rm = T, w = perwt))) %>%
  rownames_to_column() %>%
  select(Rank = rowname, `State` = state, `Proportion same-sex` = prop_samesex,
         `Mean policy score`)

state_tab %>%
  kable(booktabs = T, 
        linesep = '',
        caption = 'States ranked by proportion immigrant couples with same-sex partners') %>%
      footnote(general = "American Community Survey 2008-2019. Authors\' calculations.",
           general_title = 'Source:',
           footnote_as_chunk = T) 

state_vec <- state_tab$`Mean policy score`
names(state_vec) <- state_tab$`State`
```

Table \ref{tab:country-tab} ranks the proportion of U.S. immigrants in same-sex couples based on country of origin, averaging over the 11 years of survey data. The top sending countries mostly held more progressive policies in year of departure for immigrants in our sample, but Singapore, Malaysia, and Zimbabwe maintained generally repressive policies. Table \ref{tab:state-tab} similarly ranks U.S. state by the proportion of immigrants in same-sex couples, averaging over the period of interest. Although states with progressive policies make the top of the list, somewhat repressive Mississippi lands at rank 8, and Montana, Missouri, and Florida still make the list with more neutral policies.  


## Model Results

```{r country-props-mods}
# acs_prop_yrimmig_policy <- acs_prop_yrimmig_policy %>%
#   filter(yrimmig >= 1992)

# ag <- lm(I(log(n_same_sex+1)) ~ origin_score + I(log(n_total+1)), 
#          data = acs_prop_yrimmig_policy) 
# 
# 
# ag_country_orig <- lm(I(log(n_same_sex+1))  ~ distw + contig + comlang_off + comlang_ethno + colony +
#                    wage_dif + unemp_dif + polity5 + origin_score + stock_prop+ I(log(n_total+1)), 
#          data = acs_prop_yrimmig_policy)
# 
# ag_country_orig_fe <- lm(I(log(n_same_sex+1))  ~ distw + contig + comlang_off + comlang_ethno + colony +
#                    wage_dif + unemp_dif + polity5 + origin_score + stock_prop + bpld+ I(log(n_total+1)), 
#          data = acs_prop_yrimmig_policy)



ag <- lm(prop_same_sex ~ origin_score,
         data = acs_prop_yrimmig_policy)


ag_country_orig <- lm(prop_same_sex ~ distw + contig + comlang_off + comlang_ethno + colony +
                   wage_dif + unemp_dif + polity5 + origin_score + stock_prop,
         data = acs_prop_yrimmig_policy)

ag_country_orig_fe <- lm(prop_same_sex ~ distw + contig + comlang_off + comlang_ethno + colony +
                   wage_dif + unemp_dif + polity5 + origin_score + stock_prop + bpld,
         data = acs_prop_yrimmig_policy)



# Add binary indicator for post-2013
# ag_country_orig_2013 <- lm(prop_same_sex ~ distw + contig + comlang_off + comlang_ethno + colony +
#                    wage_dif + unemp_dif + polity5 + origin_score + stock_prop +
#                      post_2013,
#          data = mutate(acs_prop_yrimmig_policy, post_2013 = (yrimmig > 2013)))

ag_country_orig_fe_2013 <- lm(prop_same_sex ~ distw + contig + comlang_off + comlang_ethno + colony +
                   wage_dif + unemp_dif + polity5 + origin_score + stock_prop + bpld +
                     post_2013,
         data = mutate(acs_prop_yrimmig_policy, post_2013 = (yrimmig > 2013)))


ag_2013_int_fe <- lm(prop_same_sex ~ distw + contig + comlang_off + comlang_ethno + colony +
                   wage_dif + unemp_dif + polity5  + stock_prop + bpld +
                     post_2013*origin_score,
         data = mutate(acs_prop_yrimmig_policy, post_2013 = (yrimmig > 2013)))


ag_2013_spouse_int <- lm(prop_spouse_same_sex ~ distw + contig + comlang_off + 
                           comlang_ethno + colony + bpld +
                   wage_dif + unemp_dif + polity5  + stock_prop +
                     post_2013*origin_score,
         data = mutate(acs_prop_yrimmig_policy, post_2013 = (yrimmig > 2013)))
```
Our first set of models predicts the percent of immigrants in same-sex couples by country of origin and year of immigration (Table \ref{tab:country-props}). Model 1 regresses this proportion on only our variable of interest: LGBT policy score in country of origin. We see that countries with more progressive LGBT policy tend to send more immigrants to the U.S. who end up in same-sex couples. The average country-level proportion of immigrants in same-sex couples is only `r mean(acs_prop_yrimmig_policy$prop_same_sex, na.rm = T)` percent, so an increase of `r coef(ag)[[2]]` per point increase in LGBT policy score represents a substantive effect.  

Models 2 and 3 in Table \ref{tab:country-props} assess the robustness of this finding. Model 2 includes traditional controls from gravity models of immigration along with a measure of democratization and one of immigrant networks. The coefficient for country-of-origin score reduces slightly but remains highly significant. Notably, it is estimated to be more than twice the effect size of democratization score; the LGBT policy environment matters much more than the overall progressiveness of government policy. Model 3 includes country-of-origin fixed effects. Although in the fixed effects model coefficient for origin score is reduced by half compared to Model 1, it remains statistically significant.


```{r country-props}
se_list <- list()
mod_list <- list(ag, ag_country_orig, ag_country_orig_fe,
                 ag_country_orig_fe_2013, ag_2013_int_fe, 
                 ag_2013_spouse_int)
for(mod_num in 1:length(mod_list)){
  se_list[[mod_num]] <- coef(summary(mod_list[[mod_num]], cluster = c("bpld")))[, 2]
}


stargazer(mod_list,
          header = F,
          model.names = F,
          keep = c('origin_score', 'polity5', 'post_2013'),
          order = paste0("^", c('origin_score', 'polity5', 'post_2013TRUE', 
                                'post_2013TRUE:origin_score') , "$"),
          covariate.labels = c('Country LGBT policy score', 'Polity5 democratization',
                                'Post-2013', 'Country score × Post-2013'),
          dep.var.labels   = c("Percent in same-sex couples", "Married"),
          add.lines = list(c('Country controls?', 'no', rep('yes', 5)),
                           c('Country FEs?', 'no', 'no', rep('yes', 4))),
          se = se_list,
          keep.stat = c('n'),
          star.cutoffs = c(0.1, 0.05, 0.01, 0.001),
          star.char = c('†', '*', '**', '***'),
          notes = c("Note: †p<0.1; *p<0.05; **p<0.01; ***p<0.001",
                    "Source: American Community Survey 2008-2019"),
          notes.label = '',
          notes.align = 'l',
          notes.append = F,
          label = 'tab:country-props',
          title = 'OLS regressions of percent of immigrants in same-sex couples by year of immigration and country of origin. Country-clustered standard errors shown in parentheses. Country controls include population-weighted distance, contiguous border, common official language, common ethnic language, colonial relationship, wage differential, unemployment differential, proportion same-country stock, and Polity 5 measure of democratization.')


# mod_list <- list(ag, ag_country_orig, ag_country_orig_fe, 
#                  ag_country_orig_fe_2013, ag_2013_int_fe, ag_2013_spouse_int)
# for(mod_num in 1:length(mod_list)){
#   mod_list[[mod_num]] <- coef(summary(mod_list[[mod_num]], cluster = c("bpld")))
# }
# 
# keep_coefs <- c('Country LGBT policy score' = 'origin_score', 
#                 'Polity5 democratization' = 'polity5', 
#                 'Post-2013' = 'post_2013TRUE', 
#                 'Country score × Post-2013' = 'post_2013TRUE:origin_score')
#    
# 
# export_summs(mod_list,
#        coefs = keep_coefs,
#        statistics = c('N' = 'nobs'),
#        stars = c(`†`= 0.1, `*`= 0.05, `**` = 0.01, `***` = 0.001),
#        note = '{stars}. 
#                Source: American Community Survey 2008-2019') %>%
#   set_caption('OLS regressions of percent of immigrants in same-sex couples by year of immigration and country of origin. Country-clustered standard errors shown in parentheses. Country controls include population-weighted distance, contiguous border, common official language, common ethnic language, colonial relationship, wage differential, unemployment differential, proportion same-country stock, and Polity 5 measure of democratization.') %>%
#   add_rows(matrix(c('Country controls?', 'no', rep('yes', 5),
#                 'Country FEs?', 'no', 'no', rep('yes', 4)),
#            byrow = T, nrow = 2) , 
#            after = nrow(.) - 1)

```


Models 4, 5, and 6 in Table \ref{tab:country-props} assess how the 2013 Supreme Court decision striking down DOMA figures into these processes. Model 4 is the same as Model 3, but with a dichotomous "Post-2013" variable added. The influence of sending-country policy loses its significance in this model: 2013 was a significant turning point for LGB immigrants to the U.S., with the average representation from a given country growing by a quarter of a percent. Model 5 adds an interaction between sending-country LGBT policy score and the post-2013 dichotomous variable. This variable is significant and positive, while the other variables of interest lose significance. Sending-country policy and the post-2013 era both matter, but only in tandem: Only LGB immigrants from progressive countries see a boost in representation after the DOMA decision.  

Finally, Model 6 restricts the sample to only married same-sex couples. Since the DOMA decision permitted visa sponsorship for same-sex spouses, this is subpopulation in which we would expect to see the greatest discontinuity pre- and post-2013. Indeed, for immigrants married to same-sex spouses the post-2013 variable and its interaction with sending-country policy score are both significant and positive. Although before 2013 progressive countries did not send more same-sex married couples, after 2013 these numbers grew sharply, and more progressive countries received an extra boost. 


```{r state-props}
state_prop <- lm(same_prop ~ state_policy, data = acs_dyad_policy)

state_prop2 <- lm(same_prop ~ origin_score + state_policy, data = acs_dyad_policy)

state_prop_fe <- lm(same_prop ~ state_unemploy + state_income + state + 
                        origin_score + state_policy, 
                       data = acs_dyad_policy)

state_prop_fe2 <- lm(same_prop ~ state_policy + origin_score + distw + contig + 
                          comlang_off + comlang_ethno + colony +
                          wage_dif + unemp_dif + polity5 + stock_prop +
                           state_unemploy + state_income + Country + state, 
                       data = acs_dyad_policy)

state_prop_2013 <- lm(same_prop ~ post_2013 + state_policy + origin_score + distw + contig + 
                          comlang_off + comlang_ethno + colony +
                          wage_dif + unemp_dif + polity5 + stock_prop +
                           state_unemploy + state_income + Country + state, 
                       data = mutate(acs_dyad_policy, post_2013 = (year > 2013)))

state_prop_2013_int <- lm(same_prop ~ post_2013*(state_policy + origin_score) + distw + contig + 
                          comlang_off + comlang_ethno + colony +
                          wage_dif + unemp_dif + polity5 + stock_prop +
                           state_unemploy + state_income + Country + state, 
                       data = mutate(acs_dyad_policy, post_2013 = (year > 2013)))

# state_prop_2013 <- lm(same_prop ~ post_2013*(state_policy + origin_score), 
#                        data = mutate(acs_dyad_policy, post_2013 = (year > 2013)))
# state_prop_2013_2 <- lm(same_prop ~ post_2013*(state_policy + origin_score) + distw + contig + 
#                           comlang_off + comlang_ethno + colony +
#                           wage_dif + unemp_dif + polity5 + 
#                            state_unemploy + state_income + Country + state, 
#                        data = mutate(acs_dyad_policy, post_2013 = (year > 2013)))

se_list <- list()
mod_list <- list(state_prop, state_prop2, state_prop_fe, state_prop_fe2, 
                 state_prop_2013, state_prop_2013_int)

for(mod_num in 1:length(mod_list)){
  se_list[[mod_num]] <- coef(summary(mod_list[[mod_num]], cluster = c("state")))[, 2]
}


stargazer(mod_list,
          header = F, 
          keep = c('origin_score', 'state_policy', 'post_2013'),
          # omit = c('Country', 'state'),
          order = c('state_policy', 'origin_score', 'post_2013'),
          #covariate.labels = c('State LGBT policy score', 'Country LGBT policy score'),
          dep.var.labels = "Percent in same-sex couples",
          add.lines = list(c('State controls and FEs?', 'no', 'no', rep('yes', 4)),
                           c('Country controls and FEs?', rep('no', 3), rep('yes', 3))),
          se = se_list,
          keep.stat = c('n'),
          star.cutoffs = c(0.1, 0.05, 0.01, 0.001),
          star.char = c('†', '*', '**', '***'),
          notes = c("Note: †p<0.1; *p<0.05; **p<0.01; ***p<0.001", 
                    "Source: American Community Survey 2008-2019"), 
          notes.label = '',
          notes.align = 'l',
          notes.append = F,
          label = 'tab:state-props',
          title = 'Percent same-sex in by country of origin, U.S. state, and survey year. Country-clustered standard errors are shown in parentheses. State controls include unemployment rate and per-capita income. Country controls include population-weighted distance, contiguous border, common official language, common ethnic language, colonial relationship, wage differential, unemployment differential, proportion same-country stock, and Polity 5 measure of democratization.')

origin_effect <- sd(acs_couple_policy$origin_score, na.rm = T)*coef(state_prop2)[['origin_score']]
state_effect <- sd(acs_couple_policy$state_policy, na.rm = T)*coef(state_prop2)[['state_policy']]

```

We next turn to the effects of U.S. state LGBT policy. Table \ref{tab:state-props} presents models of U.S. state-level proportion of immigrants in same-sex couples, from a given country of origin in a given survey year. Model 1 contains only one predictor: U.S. state policy score in the survey year. We see that, on average, states with more friendly LGBT policies have somewhat higher proportions of immigrants in same-sex couples. Model 2 adds a predictor for country-of-origin policy score at the mean year of immigration. Although the coefficient for country of origin score is more precisely estimated, the two variables have effects of roughly equal size. A one-standard deviation (`r sd(acs_couple_policy$origin_score, na.rm = T)`-point) increase origin score is associated with a `r origin_effect` percentage-point increase of immigrants in same-sex couples, whereas the corresponding state policy standard deviation increase of `r sd(acs_couple_policy$state_policy, na.rm = T)` points is `r state_effect` percentage points.   

<!-- Although more LGBT-friendly policies in both locations are associated with higher numbers of immigrants in same-sex couples, country-of-origin LGBT policy is a stronger predictor than U.S. state policy, even considering the somewhat different scale of these variables.    -->

According to the descriptive analysis above, immigrants in same-sex couples tend to have higher incomes and hold more prestigious occupations than immigrants in different-sex couples. This implies that immigrants in same-sex couples may be attracted to progressive states for their economic rather than political benefits, so Model 3 adds state-level controls and fixed effects. Indeed, in this model, the coefficient for state policy is reduced and rendered insignificant. Model 4 adds country-of-origin controls and fixed effects. The state policy effect remains imprecisely estimated, but country-of-origin policy has increased in strength. More progressive sending countries are represented by greater proportions of same-sex couples, while U.S. state policy appears to have little influence on their settlement patterns, at least in aggregate proportions.

```{r ord}

ord_basic <- polr(state_policy_binned ~ same_sex + as.factor(year),
                data = acs_couple_policy_small, Hess = T)
ord_orig <- polr(state_policy_binned ~ same_sex*origin_score + as.factor(year),
                data = acs_couple_policy_small, Hess = T)
ord_interact <- polr(state_policy_binned ~ same_sex*(origin_score + gender + age + educ + 
                   nchild + log_income + no_income + yrimmig) + as.factor(year),
                data = rename(acs_couple_policy_small, gender = sex), Hess = T)

se_list <- list()
mod_list <- list(ord_basic, ord_orig, ord_interact)
for(mod_num in 1:length(mod_list)){
  se_list[[mod_num]] <- coef(summary(mod_list[[mod_num]], cluster = c("bpld")))[, 2]
}

stargazer(mod_list,
          header = F, 
          add.lines = list(c('Survey year FEs?', rep('yes', 3)),
                           c('Individual controls?', 'no', 'no', 'yes')),
          se = se_list,
          omit = c('gender', 'age', 'educ', 'nchild', 'log_income', 'no_income', 'yrimmig',
                   'Constant', 'year'),
          dep.var.labels   = "Binned state LGBT policy score",
          covariate.labels = c('Same-sex', 'Country LGBT policy score', 'Same-sex × country score'),
          keep.stat = 'n',
          star.cutoffs = c(0.1, 0.05, 0.01, 0.001),
          star.char = c('†', '*', '**', '***'),
          notes = c("Note: †p<0.1; *p<0.05; **p<0.01; ***p<0.001", 
                    "Source: American Community Survey 2008-2019"), 
          notes.label = '',
          notes.align = 'l',
          notes.append = F,
          #no.space = T,
          label = 'tab:ord',
          title = 'Individual ordered logit analysis of three-category state policy score. Country-clustered standard errors are shown in parentheses. Individual controls include sex, age, education, number of children, log(income), indicator for no income, and year of immigration, which are all interacted with the indicator for same-sex couple.')

newdat <- data.frame(same_sex = rep(c(F, T), 12), year = rep(2008:2019, each = 2))
ord_probs <- cbind(newdat,
      predict(ord_basic, 
        newdat,
        type = 'probs')) %>%
  group_by(same_sex) %>%
  summarize(Repressive = mean(Repressive),
            Neutral = mean(Neutral),
            Progressive = mean(Progressive)) 

#table(acs_couple_policy$state_policy_binned) 

```

Our final set of models focuses on the individual. Conditional on migrating to the U.S., do immigrants in same-sex couples choose to live in more progressive states than their heterosexual counterparts? Table \ref{tab:ord} presents ordered logit models predicting whether an individual partnered immigrant lives in a U.S. state with repressive, neutral, or progressive LGBT policies, pooling data across survey years. Model 1 includes only one regressor: an indicator for whether the immigrant is in a same-sex couple. The positive coefficient indicates that immigrants in same-sex couples indeed tend to live in states with more LGBT-friendly policies. The predicted probability for an immigrant in a different-sex couple to live in a state with progressive LGBT policies is `r ord_probs[[1, 'Progressive']]`, whereas the corresponding probability for those in same-sex couples is `r ord_probs[[2, 'Progressive']]`. At the repressive end of the policy spectrum, the predicted probabilities are `r ord_probs[[1, 'Repressive']]` and `r ord_probs[[2, 'Repressive']]` for different- and same-sex couples, respectively.  

How does country-of-origin context mediate this results? Model 2 adds sending-country LGBT policy score at the time of immigration to the regression, interacting it with the same-sex indicator. The coefficient for the same-sex indicator remains positive and significant, but we see opposite effects of the origin-score coefficient for immigrants in different- and same-sex couples. For different-sex couples, hailing from a more progressive country is associated with living in a more repressive U.S. state. For same-sex couples, the result is in the opposite direction: those from progressive countries tend to live in more progressive U.S. states.  

Model 3 controls for possible individual confounders, interacting them with the same-sex indicator. If immigrants in same-sex couples also tend to have more education, higher income, different family structures, or less years of age, they may be choosing more progressive states due to other policies or economic conditions. As shown in Table \ref{tab:ord}, our variables of interest remain strong and in the same directions in this final model.  

```{r sim1, eval = F}

## Simulation
set.seed(185)
sims <- 250
sim <- list()
sim_mod <- list(sims)
pseudeo_mod <- ord_interact
k <- length(coef(ord_interact))
theta_mat <- rmvnorm(sims, mean=c(coef(ord_interact), ord_interact$zeta),
                              sigma=vcovCL(ord_interact, cluster = ~ bpld))

var <- 'origin_score'

for (i in 1:sims) {
  if(i %% 10 == 0) print(i)
  theta <- as.numeric(theta_mat[i,])
  pseudeo_mod$coefficients <- theta[1:k]
  pseudeo_mod$zeta <- theta[(k+1):length(theta)]

  for(same_loop in unique(acs_couple_policy_small$same_sex)){
      var_vals <- seq(min(acs_couple_policy_small[,var]), 
                      max(acs_couple_policy_small[,var]), 
                      length.out = 10)
      for(val in var_vals){
          sim_dat <- acs_couple_policy_small %>%
            rename(gender = sex) %>%
            select(all.vars(formula(ord_interact)))
          sim_dat[, 'same_sex'] <- same_loop
          sim_dat[, var] <- val

          pred_dat <- predict(pseudeo_mod, newdata = sim_dat, type = 'probs')
          # pred_dat <- data.frame(t(apply(pred_dat, 2, mean))) %>%
          #   pivot_longer(cols = everything(), names_to = 'state_policy', values_to = 'fit')
          
         sim[[paste0(var,same_loop, val, i)]] <-
          data.frame(t(apply(pred_dat, 2, mean)),
                            same_sex = same_loop,
                            # variable = var,
                            origin_score = val)
      }
  }
}

sim_df <- bind_rows(sim) %>%
  pivot_longer(1:3, names_to = 'state_policy', values_to = 'fit') %>%
  group_by(same_sex, origin_score, state_policy) %>%
  summarize(fit.low = quantile(fit, .025), fit.high = quantile(fit, .975), fit = mean(fit))

write_csv(sim_df, here('draft', 'sim_df.csv'))
```

```{r sim, fig.cap = 'Predicted probabilities of U.S. state LGBT policy progressiveness for individual immigrants in different- and same-sex couples, based on policy score of sending country, with 95% confidence intervals.'}
# Mode <- function(x) {
#   ux <- unique(x)
#   ux[which.max(tabulate(match(x, ux)))]
# }
# 
# acs.means <- acs_couple_policy %>% 
#   summarize(across(c(age, origin_score, yrimmig, nchild, log_income), mean, na.rm = T))
# acs.modes <- acs_couple_policy %>% 
#   rename(gender = sex) %>%
#   summarize(across(c(educ, no_income, gender), Mode))
# 
# #Make a dataframe that's the mode of the factor variables vs. mean - one row data frame
# #Two dataframes, one for same-sex and one for not. And then make two plots.
# plot.dat <- bind_rows(rep(list(bind_cols(acs.means, acs.modes)),14)) %>%
#   mutate(origin_score = -3:10, year = 2014)
# 
# plot.dat.same <- plot.dat %>%
#   mutate(same_sex = T)
# plot.dat.dif <- plot.dat %>%
#   mutate(same_sex = F)
# 
# # Confidence intervals
# set.seed(1858)
# sims <- 500
# sim_mod <- list(sims)
# pseudeo_mod <- ord_interact
# k <- length(coef(ord_interact))
# theta_mat <- rmvnorm(sims, mean=c(coef(ord_interact), ord_interact$zeta),
#                               sigma=vcovCL(ord_interact, cluster = ~ bpld))
# 
# for (i in 1:sims) {
#   theta <- as.numeric(theta_mat[i,])
#   pseudeo_mod$coefficients <- theta[1:k]
#   pseudeo_mod$zeta <- theta[(k+1):length(theta)]
#   sim_mod[[i]] <- as.data.frame(cbind(i,-3:10, predict(pseudeo_mod, 
#                                    newdata=plot.dat.same, type="probs")))
#   names(sim_mod[[i]]) <- c("iter","origin_score", names(sim_mod[[i]])[3:5]) 
# }
# sim_mod_same <- bind_rows(sim_mod) %>%
#   pivot_longer(3:5, names_to = 'state_policy_binned', values_to = 'phat') %>%
#   #gather(state_policy_binned, phat, -iter, -origin_score) %>%
#   group_by(origin_score, state_policy_binned) %>%
#   dplyr::summarize(phat.se = sd(phat),
#                    phat.mean = mean(phat),
#                    phat.lo = phat.mean - 1.96*phat.se,
#                    phat.hi = phat.mean + 1.96*phat.se) %>%
#   mutate(same_sex = 'Same-Sex')
# 
# 
# sims <- 250
# sim_mod <- list(sims)
# pseudeo_mod <- ord_interact
# k <- length(coef(ord_interact))
# theta_mat <- rmvnorm(sims, mean=c(coef(ord_interact), ord_interact$zeta),
#                               sigma=vcovCL(ord_interact, cluster = ~ bpld))
# 
# for (i in 1:sims) {
#   theta <- as.numeric(theta_mat[i,])
#   pseudeo_mod$coefficients <- theta[1:k]
#   pseudeo_mod$zeta <- theta[(k+1):length(theta)]
#   sim_mod[[i]] <- as.data.frame(cbind(i,-3:10, predict(pseudeo_mod, 
#                                    newdata=plot.dat.dif, type="probs")))
#   names(sim_mod[[i]]) <- c("iter","origin_score", names(sim_mod[[i]])[3:5]) 
# }
# sim_mod_dif<- bind_rows(sim_mod) %>%
#   pivot_longer(3:5, names_to = 'state_policy_binned', values_to = 'phat') %>%
#   #gather(state_policy_binned, phat, -iter, -origin_score) %>%
#   group_by(origin_score, state_policy_binned) %>%
#   dplyr::summarize(phat.se = sd(phat),
#                    phat.mean = mean(phat),
#                    phat.lo = phat.mean - 1.96*phat.se,
#                    phat.hi = phat.mean + 1.96*phat.se) %>%
#   mutate(same_sex = 'Different-Sex')
# 
# sim_df <- bind_rows(sim_mod_same, sim_mod_dif)
# 
# sim_df %>%
#   ggplot(aes(x=origin_score, y=phat.mean, col=state_policy_binned)) +
#   geom_line() + 
#   geom_ribbon(aes(ymin=phat.lo, ymax=phat.hi, 
#                   fill = state_policy_binned, col = NULL), alpha = .2) +
#   facet_wrap(~same_sex) +
#   xlab('LGBT policy score for country of origin') +
#   ylab('Predicted probability of U.S. state residence') +
#   theme(legend.justification=c(1,0),
#         legend.position=c(.95,.38))


sim_df <- read_csv(here('draft', 'sim_df.csv')) %>%
    mutate(same_sex = case_when(same_sex == T ~ 'Same-sex',
                                same_sex == F ~ 'Different-sex'))


sim_df %>%
  ggplot(aes(x=origin_score, y=fit, col=state_policy)) +
  geom_line() + 
  geom_ribbon(aes(ymin=fit.low, ymax=fit.high, 
                  fill = state_policy, col = NULL), alpha = .2) +
  facet_wrap(~same_sex) +
  xlab('LGBT policy score for country of origin') +
  ylab('Predicted probability of U.S. state residence') +
  theme(legend.justification=c(1,0),
        legend.position=c(.95,.38))

orig_max <- max(sim_df$origin_score)
same_pred <- filter(sim_df, same_sex == T, origin_score == orig_max, 
       state_policy == 'Progressive') %>% 
  pull(fit)

dif_pred <- filter(sim_df, same_sex == F, origin_score == orig_max, 
       state_policy == 'Progressive') %>% 
  pull(fit)

same_pred2 <- filter(sim_df, same_sex == T, origin_score == orig_max, 
       state_policy == 'Repressive') %>% 
  pull(fit)

dif_pred2 <- filter(sim_df, same_sex == F, origin_score == orig_max, 
       state_policy == 'Repressive') %>% 
  pull(fit)
```

To help interpret these results, Figure \ref{fig:sim} contains predicted probabilities of residing in progressive, neutral, or repressive U.S. states. For each of 250 simulations, the coefficients are drawn from this covariance matrix as estimated in Model 3 in Table \@ref(tab:ord). These are used to predict the probably of being in each type of state for each member in the complete dataset, with their couple type set to same- or different-sex and their origin score varied from the minimum to maximum. The predicted probabilities are are averaged across the entire dataset for each of these manipulated values. After 250 simulations, the distribution of predicted values is used to find means and 95-percent confidence intervals. The only difference between the two panels is the value for the same-sex indicator in the simulations.  

The figure shows opposite trends for same- and different-sex couples. Overall, immigrants tend to live in more progressive states, but the moderating effect of origin score is quite different for the two groups. The panel for same-sex couples shows that these immigrants tend to live in U.S. states with similar LGBT policy contexts to those of their countries of origin. Immigrants in same-sex couples from repressive countries are less likely to live in progressive U.S. states, but as the origin-country score increases, so does the probability of living in a progressive state. For immigrants in different-sex couples, on the other hand, increasingly progressive country-of-origin policies are associated with a *lower* probability of residing in a progressive U.S. state, accompanied by a *higher* probability of living in a repressive U.S. state. At the high end of the origin-score policy range, the difference in predicted probabilities is significant: typical immigrants in same-sex couples are `r 100*(same_pred - dif_pred)` percentage points more likely to live in progressive states and  `r 100*(dif_pred2 - same_pred2)` percentage points less likely to live in repressive states than similar immigrants in different-sex couples.

## Sensitivity Analysis
We first assess how much our results would change in the presence of significant measurement error. @kreider_2015 found that in the 2010 ACS, 57 percent of married and 7 percent of unmarried same-sex couples may have been different-sex couples that misreported a partner's sex. By 2016 the mismatch rate had declined to 31 percent of married and 3 percent of unmarried same-sex couples [@kreider_2017]. 

Figure \ref{fig:sens} takes Model 3 form Table \ref{tab:country-props} and reduces the proportions of same-sex couples in the data. It varies the percentage of misreported same-sex married couples from 0 to 90 percent and of unmarried couples from 0 to 30 percent. Highlighted in blue bars are the empirical mismatch rates found in the two studies by Kreider et al. [-@kreider_2015; -@kreider_2017]. We see that extremely high rates of misreporting are necessary to reduce this effect to 0. 

```{r sens, eval = F, fig.cap = 'Coefficient for sending-country LGBT policy context, adjusted for possible misreporting of same-sex couples. Ribbon shows 95 percent confidence intervals and blue bars show estimated misreporting from the 2010 and 2016 U.S. Census Bureau tests on the ACS.'}

acs_prop_yrimmig_policy <- acs_prop_yrimmig_policy %>%
  mutate(prop_same_sex_adj = (prop_spouse_same_sex*(1-.573) + prop_partner_same_sex*(1-.07)))

lm(prop_same_sex_adj ~ distw + contig + comlang_off + comlang_ethno + colony +
                   wage_dif + unemp_dif + polity5 + origin_score + stock_prop + bpld,
         data = acs_prop_yrimmig_policy) %>%
  summary()
#.35 .034


sens_df <- list()
mis_df <- data.frame(spouse = sort(c(.573, .35, seq(from = 0, to = .9, length.out = 8))),
           partner = sort(c(.07, .034, seq(from = 0, to = .3, length.out = 8))))

for(i in 1:nrow(mis_df)){
  sens_mod <- lm(prop_same_sex_adj ~ distw + contig + comlang_off + comlang_ethno + colony +
                   wage_dif + unemp_dif + polity5 + origin_score + stock_prop + bpld,
         data = acs_prop_yrimmig_policy %>%
           mutate(prop_same_sex_adj = (prop_spouse_same_sex*(1-mis_df[i,1]) + 
                                         prop_partner_same_sex*(1-mis_df[i,2])))
         )
  
  coef_os <- coef(summary(sens_mod, cluster = c("bpld")))['origin_score',]
  sens_df[[i]] <- data.frame(est = coef_os[[1]],
                             se = coef_os[[2]],
                             mis_spouse = mis_df[i,1],
                             mis_partner = mis_df[i,2])
}
sens_df <- bind_rows(sens_df) %>%
  mutate(lower = est - 1.96*se, 
         upper = est + 1.96*se,
         highlight = mis_spouse %in% c(.573, .35))

ggplot(sens_df, aes(x = (mis_spouse+mis_partner)/2, y = est)) +
  geom_line() +
  geom_ribbon(aes(ymin = lower, ymax = upper), alpha = .2)  +
  geom_hline(yintercept = 0, linetype = 'dashed') +
  geom_errorbar(aes(ymin = lower, ymax = upper, width = .02, color = highlight)) +
  theme(legend.position = "none") +
  scale_color_manual(values = c('transparent', RColorBrewer::brewer.pal(3, 'Dark2')[3])) +
  labs(y = 'Coefficient for LGBT policy context')
```

We next text the robustness of our results to omitted variable bias.


# Discussion
In 2013, there were `r round(same_2013 /1e3, 1)` thousand same-sex couples that included immigrants in the U.S. By 2019, this number had nearly doubled to `r round(same_2019 /1e3, 1)` thousand. Despite this expansive growth of same-sex immigrant couples in the U.S. far outpacing overall migration rates, there is little demographic research understanding the characteristics of these couples or the factors influencing their migratory patterns. Consequently, we know little about who these migrants are, why they are choosing to leave their home countries, or where they are choosing to locate once in the U.S. Answering these questions is important, not just because this represents an increasing number of border crossers, but because this process has the potential to reshape our conceptualization of who immigrants are and their motivations for moving.  

The rising number of same-sex immigrant couples has coincided with a dramatic change in policy environments governing LGBT communities -- both within the U.S. and abroad. Indeed, it is precisely because of this changing policy environment, namely around the 2013 DOMA Supreme Court case, that same-sex couples now have a legal pathway into the U.S. that does not rely on asylum claims. Therefore, although there are numerous perspectives to take in understanding the migratory patterns of these couples, this project specifically investigates how changing LGBT policies at both country of origin and residing U.S. state pattern these migratory pathways. Engaging in such a question adds to emerging scholarship trying to understand how dramatic policy changes are influencing the health, well-being, and lifestyles of LGBT people while also recognizing that these policies differentially impact people within this broad umbrella based on different social positions (xx). Moreover, it helps to address an important gap within migration studies that too often discount the role of the state and the salience of sexuality in conditioning migratory patterns [@carrillo_2018; @fitzgerald_2014].  

To answer this question, we take advantage of an underutilized data source: self-reports of same-sex immigrant couples in the American Community Survey from 2008-2019. Despite this resource being one of the few national surveys to capture same-sex couples or immigrant couples, these data are virtually untapped for this purpose. Few studies use the ACS to analyze same-sex couples, and the ones that do largely focus on residential segregation [e.g. @poston_2017]. Therefore, these data allow for us to make one of the first large-$N$ investigations of same-sex immigrant couples within the U.S. and to make an important correction to this area of scholarship.  

Using these data, we make a number of interesting findings worth detailing. First, existing scholarship on same-sex immigrant couples, and queer migration more broadly, largely focuses on the asylum and refugee processes. This is because this was one of the only mechanisms to get into the U.S. [@humanrightswatch_2006]; xx). Consequently, this over-representation distorts our understanding of who same-sex immigrant couples are, the types of environments they are leaving from, and their motivations to seek entry into the U.S. Indeed, when comparing the demographics of same-sex immigrant couples to different-sex immigrant couples, we find same-sex couples generally have higher incomes and occupational prestige and are somewhat more educated. Understanding this profile alone is an important insight as it reveals that these communities are of privileged social standing. This is a corrective to the queer migration literature that has yet to highlight this profile. It is interesting that, although it is known migration is a taxing endeavor, migrants in same-sex couples come from stronger social positions than migrants in different-sex relationships.  

Understanding who these migrants are, how do LGBT policies in their countries of origin influence their desires to come to the U.S.? Despite existing scholarship portraying a story of LGB couples fleeing repression, as necessary for refugee claims, LGB couples are leaving countries with more progressive policy environments. As results in Table \ref{tab:country-props} and trendlines in Figure \ref{fig:policy-desc} reveal, couples are coming from more open environments. This is true even after accounting for more traditional gravity model variables that primarily focus on economic costs and benefits to migration. Though more research is needed, these results, in conjunction with the fact that these same-sex couples achieve higher incomes and greater occupational prestige, describe a situation in which perhaps it is the supportive policy environment, such as employment protections, access to the material benefits of marriage, and so forth, that enable same-sex couples to achieve greater social standing and the resources necessary to migrate. Or, instead of the immediate benefits of the policy itself, these supportive environments may simply encourage LGB people to feel comfortable to openly identify as being in a relationship when asked by surveyors.   

One unexpected finding is different-sex couples from more LGBT-friendly countries are likelier to reside in states with increasingly less LGBT-friendly policies. These patterns in Figure \ref{fig:sim} are peculiar because we suspected that state LGBT policies to have no association with how different-sex couples are making decisions as to where to reside. This is not the case. One immediate question this raises is if this is a case of “straight flight.” White flight is a well-research process in which white people leave diversifying communities. After straight couples experience liberalized conditions for gay couples, do they intentionally seek to leave such conditions by moving to states that are less supportive? More research is needed to understand this pattern.  

Recent research has argued that sexuality is a salient factor determining immigration decisions. We show that differences between immigrants in same-sex couples and those in different-sex couples cannot be explained solely using classic theories of migration; policy context and sexuality interact in complicated ways to shape migratory flows. This points to the importance of further studying the interaction between the state and identity in migratory processes.



# References
\setlength{\parindent}{-0.2in}
\setlength{\leftskip}{0.2in}
\setlength{\parskip}{8pt}
\noindent


